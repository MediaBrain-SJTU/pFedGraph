# pFedGraph algorithm on Tensorflow

## Introduction

This code is the tensorflow version of pFedGraph algorithm.

## Environment

We use tensorflow in the environment as follows.

```python
absl-py                      2.3.1
accelerate                   1.10.1
addict                       2.4.0
affine                       2.4.0
afinn                        0.1
aiohappyeyeballs             2.6.1
aiohttp                      3.13.0
aiosignal                    1.4.0
albucore                     0.0.24
albumentations               2.0.8
alembic                      1.16.5
altair                       5.5.0
annotated-types              0.7.0
anthropic                    0.69.0
antlr4-python3-runtime       4.9.3
anyascii                     0.3.3
anyio                        4.11.0
appdirs                      1.4.4
array_record                 0.8.3
arrow                        1.3.0
ase                          3.26.0
asttokens                    3.0.0
astunparse                   1.6.3
attrs                        25.4.0
audioread                    3.0.1
backoff                      2.2.1
bayesian-optimization        3.1.0
bayespy                      0.6.2
beartype                     0.22.2
beautifulsoup4               4.14.2
bibtexparser                 1.4.3
bidict                       0.23.1
biopython                    1.85
black                        25.9.0
bleach                       6.2.0
blinker                      1.9.0
blis                         1.2.1
boto3                        1.40.49
botocore                     1.40.49
Brotli                       1.1.0
cachetools                   5.5.2
catalogue                    2.0.10
catboost                     1.2.8
category_encoders            2.8.1
certifi                      2025.10.5
cffi                         2.0.0
chardet                      5.2.0
charset-normalizer           3.4.3
clarabel                     0.11.1
click                        8.3.0
click-plugins                1.1.1.2
cligj                        0.7.2
cloudpathlib                 0.23.0
cloudpickle                  3.1.1
cmake                        4.1.0
cmudict                      1.1.1
colorama                     0.4.6
coloredlogs                  15.0.1
colorlog                     6.9.0
comm                         0.2.3
confection                   0.1.5
ConfigArgParse               1.7.1
contourpy                    1.3.3
contractions                 0.1.73
coolname                     2.2.0
cramjam                      2.11.0
crc32c                       2.7.1
cssselect                    1.3.0
cvxpy                        1.7.4
cycler                       0.12.1
cymem                        2.0.11
dash                         3.2.0
dataclasses-json             0.6.7
datasets                     2.21.0
dateparser                   1.2.2
debugpy                      1.8.17
decorator                    5.2.1
defusedxml                   0.7.1
Deprecated                   1.2.18
dgl                          2.1.0
diffusers                    0.35.1
dill                         0.3.8
diskcache                    5.6.3
distro                       1.9.0
dm-tree                      0.1.9
dnspython                    2.8.0
docker                       7.1.0
docker-pycreds               0.4.0
docopt                       0.6.2
docstring_parser             0.17.0
donfig                       0.8.1.post1
dscribe                      2.1.2
dtaidistance                 2.3.13
e3nn                         0.5.8
editdistance                 0.8.1
effdet                       0.4.1
efficientnet_pytorch         0.7.1
einops                       0.8.1
emoji                        2.15.0
ensemble-boxes               1.0.9
et_xmlfile                   2.0.0
etils                        1.13.0
evaluate                     0.4.6
executing                    2.2.1
faiss-cpu                    1.12.0
fastai                       2.8.4
fastapi                      0.118.3
fastcore                     1.8.12
fastdownload                 0.0.7
fastdtw                      0.3.4
fastjsonschema               2.21.2
fastparquet                  2024.11.0
fastprogress                 1.0.3
fasttext                     0.9.3
fasttransform                0.0.2
filelock                     3.20.0
filetype                     1.2.0
fire                         0.7.1
Flask                        3.1.2
Flask-SocketIO               5.3.6
flatbuffers                  25.9.23
fonttools                    4.60.1
frozenlist                   1.8.0
fsspec                       2024.6.1
ftfy                         6.3.1
funcy                        2.0
future                       1.0.0
gast                         0.6.0
gdown                        5.2.0
gensim                       4.3.2
genson                       1.3.0
geographiclib                2.1
geopy                        2.4.1
gitdb                        4.0.12
GitPython                    3.1.45
google-ai-generativelanguage 0.6.15
google-api-core              2.24.2
google-api-python-client     2.165.0
google-auth                  2.38.0
google-auth-httplib2         0.2.0
google-generativeai          0.8.4
google-pasta                 0.2.0
googleapis-common-protos     1.69.2
graphviz                     0.21
greenlet                     3.2.4
grpcio                       1.76.0rc1
grpcio-status                1.71.2
gym                          0.26.2
gym-notices                  0.1.0
h11                          0.16.0
h5py                         3.14.0
haversine                    2.9.0
hf-xet                       1.1.10
hmmlearn                     0.3.3
httpcore                     1.0.9
httplib2                     0.31.0
httpx                        0.28.1
huggingface-hub              0.36.0
humanfriendly                10.0
humanize                     4.13.0
hyperopt                     0.2.7
hypothesis                   6.140.3
idna                         3.7
igraph                       0.11.9
imagecodecs                  2025.8.2
imageio                      2.37.0
imbalanced-learn             0.14.0
imgaug                       0.4.0
immutabledict                4.2.2
implicit                     0.7.2
importlib_metadata           8.7.0
importlib_resources          6.5.2
inflate64                    1.0.3
inflect                      7.5.0
iniconfig                    2.1.0
ipykernel                    6.30.1
ipython                      9.6.0
ipython_pygments_lexers      1.1.1
ipywidgets                   8.1.7
iterative-stratification     0.1.9
itsdangerous                 2.2.0
jedi                         0.19.2
Jinja2                       3.1.6
jiter                        0.11.0
jmespath                     1.0.1
joblib                       1.5.2
jpegio                       0.2.8
jsonlines                    4.0.0
jsonschema                   4.25.1
jsonschema-specifications    2025.9.1
jupyter_client               8.6.3
jupyter_core                 5.8.1
jupyterlab_pygments          0.3.0
jupyterlab_widgets           3.0.15
kaggle                       1.6.17
keras                        3.11.3
kiwisolver                   1.4.9
kornia                       0.8.1
kornia_rs                    0.1.9
langcodes                    3.5.0
language_data                1.3.0
lazy_loader                  0.4
Levenshtein                  0.27.1
libclang                     18.1.1
librosa                      0.11.0
lightgbm                     4.6.0
lightning-utilities          0.15.2
llvmlite                     0.45.1
loguru                       0.7.3
lxml                         6.0.2
lxml_html_clean              0.4.3
Mako                         1.3.10
marisa-trie                  1.3.1
Markdown                     3.9
markdown-it-py               4.0.0
markovify                    0.9.4
MarkupSafe                   3.0.3
marshmallow                  3.26.1
matplotlib                   3.10.7
matplotlib-inline            0.1.7
mdurl                        0.1.2
mistune                      3.1.4
ml_dtypes                    0.5.3
modelscope                   1.31.0
monai                        0.9.0            202206131636
monty                        2025.3.3
more-itertools               10.8.0
mpmath                       1.3.0
msgpack                      1.1.2
msgpack-numpy                0.4.8
multidict                    6.7.0
multiprocess                 0.70.16
multivolumefile              0.2.3
munch                        4.0.0
munkres                      1.1.4
murmurhash                   1.0.13
mypy_extensions              1.1.0
namex                        0.1.0
narwhals                     2.7.0
nbclient                     0.10.2
nbconvert                    7.16.6
nbformat                     5.10.4
nest-asyncio                 1.6.0
networkx                     3.5
nibabel                      5.3.2
nilearn                      0.12.1
ninja                        1.13.0
nlpaug                       1.1.11
nltk                         3.9.2
num2words                    0.5.14
numba                        0.62.1
numcodecs                    0.16.3
numpy                        1.26.4
nvidia-cublas-cu12           12.8.4.1
nvidia-cuda-cupti-cu12       12.8.90
nvidia-cuda-nvrtc-cu12       12.8.93
nvidia-cuda-runtime-cu12     12.8.90
nvidia-cudnn                 8.2.0.51
nvidia-cudnn-cu12            9.10.2.21
nvidia-cufft-cu12            11.3.3.83
nvidia-cufile-cu12           1.13.1.3
nvidia-curand-cu12           10.3.9.90
nvidia-cusolver-cu12         11.7.3.90
nvidia-cusparse-cu12         12.5.8.93
nvidia-cusparselt-cu12       0.7.1
nvidia-ml-py                 13.580.82
nvidia-nccl-cu12             2.27.3
nvidia-nvjitlink-cu12        12.8.93
nvidia-nvtx-cu12             12.8.90
nvidia-pyindex               1.0.9
omegaconf                    2.3.0
onnx                         1.19.1
onnxruntime-gpu              1.23.0
open3d                       0.19.0
openai                       2.3.0
opencv-python                4.11.0.86
opencv-python-headless       4.10.0.84
openpyxl                     3.1.5
openslide-python             1.4.2
opt_einsum                   3.4.0
opt-einsum-fx                0.1.4
optimum                      2.0.0
optree                       0.17.0
optuna                       4.5.0
optuna-integration           4.5.0
orjson                       3.11.3
osqp                         1.0.5
packaging                    25.0
palettable                   3.3.3
pandas                       2.3.3
pandocfilters                1.5.1
parso                        0.8.5
pathos                       0.3.2
pathspec                     0.12.1
patsy                        1.0.1
pdf2image                    1.17.0
peft                         0.17.1
pexpect                      4.9.0
pi_heif                      1.1.1
pillow                       11.3.0
pillow-avif-plugin           1.5.2
pillow_heif                  1.1.1
pip                          25.2
platformdirs                 4.5.0
plotly                       6.3.1
pluggy                       1.6.0
plum-dispatch                2.5.8
polars                       1.34.0
polars-runtime-32            1.34.0
pooch                        1.8.2
pox                          0.3.6
ppft                         1.7.7
preshed                      3.0.10
pretrainedmodels             0.7.4
promise                      2.3
prompt_toolkit               3.0.52
propcache                    0.4.1
proto-plus                   1.26.1
protobuf                     5.29.5
psutil                       7.1.0
ptyprocess                   0.7.0
pure_eval                    0.2.3
py-cpuinfo                   9.0.0
py4j                         0.10.9.9
py7zr                        1.0.0
pyahocorasick                2.2.0
pyaml                        25.7.0
pyarrow                      21.0.0
pyasn1                       0.6.1
pyasn1_modules               0.4.2
pybboxes                     0.1.6
pybcj                        1.0.6
pybind11                     3.0.1
pycocotools                  2.0.10
pycparser                    2.23
pycryptodomex                3.23.0
pyctcdecode                  0.5.0
pydantic                     2.12.0
pydantic_core                2.41.1
pydeck                       0.9.1
pydicom                      3.0.1
Pygments                     2.19.2
pygtrie                      2.5.0
pylibjpeg                    2.1.0
pylibjpeg-libjpeg            2.2.0
pymap3d                      3.2.0
pymatgen                     2025.10.7
pymatreader                  1.1.0
pymongo                      4.15.3
pynndescent                  0.5.13
pynvml                       13.0.1
pyocr                        0.8.5
pyparsing                    3.2.5
pypdf                        6.1.1
PyPDF2                       3.0.1
pyphen                       0.17.2
pyppmd                       1.2.0
pyproj                       3.7.2
pyquaternion                 0.9.9
PySocks                      1.7.1
pytest                       8.4.2
python-crfsuite              0.9.11
python-dateutil              2.9.0.post0
python-dotenv                1.1.1
python-engineio              4.7.1
python-Levenshtein           0.27.1
python-slugify               8.0.4
python-socketio              5.8.0
python_speech_features       0.6
pytokens                     0.1.10
pytorch-lightning            2.5.5
pytorch-msssim               1.0.0
pytorch-tabnet               4.1.0
pytz                         2025.2
PyWavelets                   1.9.0
PyYAML                       6.0.3
pyzmq                        27.1.0
pyzstd                       0.18.0
rank-bm25                    0.2.2
RapidFuzz                    3.14.1
rasterio                     1.4.3
ray                          2.49.2
rdkit                        2025.9.1
readability-lxml             0.8.4.1
referencing                  0.36.2
regex                        2025.9.18
requests                     2.32.5
requests-toolbelt            1.0.0
resampy                      0.4.3
responses                    0.25.8
retrying                     1.4.2
rich                         14.2.0
roboflow                     1.2.10
rpds-py                      0.27.1
rsa                          4.9.1
ruamel.yaml                  0.18.15
ruamel.yaml.clib             0.2.14
s3transfer                   0.14.0
sacremoses                   0.1.1
safetensors                  0.6.2
sahi                         0.11.36
scikit-image                 0.25.2
scikit-learn                 1.7.2
scikit-multilearn            0.2.0
scikit-optimize              0.10.2
scipy                        1.13.0
scs                          3.2.9
seaborn                      0.13.2
segmentation_models_pytorch  0.5.0
sentence-transformers        5.1.1
sentencepiece                0.2.1
sentry-sdk                   2.41.0
setproctitle                 1.3.7
setuptools                   80.9.0
shapely                      2.1.2
shellingham                  1.5.4
shutup                       0.2.0
simple-parsing               0.1.7
simple-websocket             1.1.0
simpleitk                    2.5.2
simsimd                      6.5.3
six                          1.17.0
sklearn-compat               0.1.4
sklearn-crfsuite             0.5.0
sklearn-pandas               2.2.0
smart_open                   7.3.1
smmap                        5.0.2
sniffio                      1.3.1
snorkel                      0.10.0
sortedcontainers             2.4.0
soundfile                    0.13.1
soupsieve                    2.8
soxr                         1.0.0
spacy                        3.8.7
spacy-legacy                 3.0.12
spacy-loggers                1.0.5
sparse                       0.17.0
spglib                       2.6.0
SQLAlchemy                   2.0.43
srsly                        2.5.1
stack-data                   0.6.3
starlette                    0.48.0
statsmodels                  0.14.5
streamlit                    1.50.0
stringzilla                  4.2.0
sympy                        1.14.0
tabulate                     0.9.0
tenacity                     9.1.2
tensorboard                  2.19.0
tensorboard-data-server      0.7.2
tensorflow                   2.19.1
tensorflow-datasets          4.9.9
tensorflow-hub               0.16.1
tensorflow-metadata          1.17.2
tensorflow-text              2.19.0
tensorpack                   0.11
termcolor                    3.1.0
terminaltables               3.1.10
text-unidecode               1.3
textblob                     0.19.0
textsearch                   0.0.24
textstat                     0.7.10
texttable                    1.7.0
tf_keras                     2.19.0
thinc                        8.3.4
thop                         0.1.1-2209072238
threadpoolctl                3.6.0
tifffile                     2025.10.4
tiktoken                     0.12.0
timm                         1.0.20
tinycss2                     1.4.0
tokenizers                   0.21.4
toml                         0.10.2
torch                        2.8.0
torch_cluster                1.6.3
torch-dct                    0.1.6
torch_discounted_cumsum      1.1.0
torch-geometric              2.6.1
torch_scatter                2.1.2
torch_sparse                 0.6.18
torch_spline_conv            1.2.2
torchaudio                   2.8.0
torchdata                    0.11.0
torchinfo                    1.8.0
torchio                      0.20.23
torchmetrics                 1.8.2
torchsort                    0.1.9
torchtext                    0.18.0
torchvggish                  0.2
torchvision                  0.23.0
torchxrayvision              1.4.0
tornado                      6.5.2
tqdm                         4.67.1
traitlets                    5.14.3
transformers                 4.49.0
transliterate                1.10.2
triton                       3.4.0
truncnorm                    0.0.2
typeguard                    4.4.4
typer                        0.19.2
types-python-dateutil        2.9.0.20251008
typing_extensions            4.15.0
typing-inspect               0.9.0
typing-inspection            0.4.2
tzdata                       2025.2
tzlocal                      5.3.1
ultralytics                  8.3.209
ultralytics-thop             2.0.17
umap-learn                   0.5.9.post2
uncertainties                3.2.3
Unidecode                    1.4.0
uritemplate                  4.2.0
urllib3                      2.5.0
uvicorn                      0.37.0
vaderSentiment               3.3.2
wandb                        0.22.2
wasabi                       1.1.3
watchdog                     6.0.0
wcwidth                      0.2.14
weasel                       0.4.1
webencodings                 0.5.1
Werkzeug                     3.1.3
wheel                        0.45.1
widgetsnbextension           4.0.14
word2number                  1.1
wrapt                        1.17.3
wsproto                      1.2.0
xgboost                      1.7.6
xlrd                         2.0.2
xmltodict                    1.0.2
xxhash                       3.6.0
yarl                         1.22.0
zarr                         3.1.3
zipp                         3.23.0 
```

## Run this code

To run this code, you can directly use

```console
cd tensorflow
bash run_cifar10.sh
```

The logs and models will saved in ./logs, ./models